sudo: false
language: python
matrix:
  include:
    - python: 2.7
      env: TOXENV=py27-cov
    - python: 3.6
      env: TOXENV=py36-cov
branches:
  only:
    - master
    - /^v\d+\.\d+.*$/

install: pip install tox
script: tox

after_success:
  - tox -e codecov

deploy:
  # deploy to PyPI on tags
  - provider: pypi
    server: https://upload.pypi.org/legacy/
    on:
      repo: googlei18n/ufo2ft
      tags: true
      all_branches: true
      python: 3.6
    user: anthrotype
    password:
      secure: XwoschGeWDAMEYRl8t70G/m3up3QEZUEzcDYraDF48+Y4wRa7rjXG9jkZbN27CSBaOzcQ6H/ugqjXlj0TNRtDeAlvE9EYZLhYVK6dCpqsjJb2OTWYHN4U2+UK73+OQo5RCPfc/qyJzWur9i3Y5Ll4RxmsDrqP+R1OpxXXZ/bP5kI2S2p4OKRDqs/QBo1yLmprE9joPWTlWyEBKnE2uttre1zgiE/eu0bn3whyrWsVd4zaIlwBk/UiXRAsg3yeFz9d1avve7Bl/OcixqyuUDSQ99oebIhhIooIoN4CRLdKJXndlUe3ZyriJEH1CdhAIYhGzU0VyrBkEYKpcMPehAzjeIU95PcchRiqBBSnnk1Eu6PSozI/we6SzoFZIiYwH2WNYmY/MkwVou692BRrDKb6um/UBUrZP3mQdvi0pbIdL3OFT4u1eYiD2e+yB16GX6F3lbNu/jKH+MwQGJHG+fZ5BSCdKFunjlGDj+nvTlueRnE6G4+SaGEq5u+fd6EpWDknvpvO+9j5zb+RlGMguZxjqyJ1YzLpLvxJUyrJQ1nhDKX+urx84/tKoN5cDUhKjxxlaph90vgQRpZuawtR547xlzZI8eMn+ZpgknJCITnCjQEgXKNyi+f6d4m+YAGQQY4QtceL5kifaoB9vbTBz+n1MeJWftOlRFNgyzegK3MRos=
    distributions: sdist bdist_wheel
  # also create a Github Release with the current tag
  - provider: releases
    api_key:
      secure: zXtgsom/sEEoj/pg0qq0qGFI93QkNEHe4gjX1AOID7oDORz1AP6nBst5zxoMJy/4DH4tNiWTQZdk+OVDmkysn5kJearDZ1uM4g02nhSYxXZ/a50p6ewciaYE1KwBt8IxiqhvvRdY2Fab1eW1aTlRjpCYoFvsovck7sWJ96dhfUMGIRzk9cbo3/JJ052kLz34lgM3PLlToN57WHu3y4TO0tXTjTdo4V8uB0l9O8j9P0ez1Q82ZPcxFicr4HUIqZn4gBu7cRXZr3PXu6Rx54eg/QFD8hVMoH9JOafmRfKmsayE6g0qDbFUMOnoMFg0on8lh2OR5EZlAznrccFccwAGNykY+CxP/dC/Io2XktrA/HIPrWy2rGojSNAYQe3LS5oW/SEbZSTGSG45VdaX7oBzgp/4eKXN/V+n3W68JGjKKN2foIFU3vAL0dm8fA+A2N/fBSR3bCyuwZ/u+Bt+ads0M6dmlBln+s8y1PPdhY4RRaU4I+7m8KOBfMUPzYeAq5DoWWDe8omtqmPHs0DMjr4gtBXOD0qeNE40ogc/LeXJ3l8e1MN8zq0OYfngJJop/HMWfyg7kaVurWCigbsJMNkMpAam8hq7BsLWncRJMQax5NHXAcAqWOVemANOW+H3gcKFPtjzOPblxZNoDK/Y6R2wiY5pfDXl1aMct2BF0mXZPNA=
    on:
      repo: googlei18n/ufo2ft
      tags: true
      all_branches: true
      python: 3.6
